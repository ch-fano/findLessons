{% extends 'user_profile/teacher_profile.html' %}
{% load crispy_forms_tags %}
{% load static %}

{% block title %} {{ title }} {% endblock %}

{% block head %}
    {{ block.super }}
    <style>
         html, body {
            height: 100%;
            margin: 0;
            display: flex;
            flex-direction: column;
        }
        .main-content {
            display: flex;
            flex-direction: column;
            flex: 1;
        }

        .teachers-list-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            margin: 15px;
        }

        .teachers-list {
            display: flex;
        .teachers-list-container h2{
            margin: 15px;
        }
            flex-wrap: wrap;
            gap: 20px;
            margin: 0 auto;
            max-width: 1200px;
            padding: 0 15px;
        }

        .teacher-container {
            display: flex;
            align-items: center;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 8px;
            background-color: #f9f9f9;
            flex: 1 1 calc(50% - 20px);
            box-sizing: border-box;
            max-width: calc(50% - 20px);
            min-width: 300px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .teacher-container:hover {
            transform: scale(1.02);
        }

        .teacher-picture {
            flex-shrink: 0;
            margin-right: 15px;
        }

        .teacher-picture img {
            width: 120px;
            height: 120px;
            object-fit: cover;
            border-radius: 50%;
        }

        .teacher-info h2 {
            margin: 10px;
            font-weight: bold;
            font-size: 1.2em;
        }

        .teacher-info p {
            margin: 10px 10px;
        }

        .form-container {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            margin: 20px auto;
            max-width: 900px;
        }

        .form-group {
            flex: 1;
            min-width: 150px;
            display: flex;
            flex-direction: column;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            box-sizing: border-box;
        }

        .form-submit {
            display: flex;
            align-items: flex-end;
        }

        .btn-custom {
            width: 100%;
        }

        .no-teachers {
            text-align: center;
            margin-top: 20px;
            flex: 1; /* Ensure it stretches to fill the space */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .no-teachers img {
            max-width: 400px;
            width: 100%;
            height: auto;
            margin-top: 20px;
        }
    </style>
{% endblock %}

{% block content %}
    <div class="main-content">
        {% if teachers %}
            <form method="post" action="{% url 'reservation:search' subject city %}">
                {% csrf_token %}
                <div class="form-container">
                    <div class="form-group">
                        <label for="{{ form.start_date.id_for_label }}">Start Date:</label>
                        {{ form.start_date }}
                    </div>
                    <div class="form-group">
                        <label for="{{ form.end_date.id_for_label }}">End Date:</label>
                        {{ form.end_date }}
                    </div>
                    <div class="form-group">
                        <label for="{{ form.order.id_for_label }}">Order By:</label>
                        {{ form.order }}
                    </div>
                    <div class="form-group form-submit">
                        <button type="submit" class="btn-custom">Filter</button>
                    </div>
                </div>
            </form>

            <div class="teachers-list-container">
                <h2>Teacher found:</h2>
                <div class="teachers-list">
                    {% for teacher in teachers %}
                        <div class="teacher-container" data-rating="{{ teacher.stars }}" onclick="location.href='{% url 'homepage'%}'">
                            <div class="teacher-picture">
                                <img src="{{ teacher.profile.picture.url }}" alt="{{ teacher.profile.first_name }} {{ teacher.profile.last_name }}">
                            </div>
                            <div class="teacher-info">
                                <h2>{{ teacher.profile.first_name }} {{ teacher.profile.last_name }}</h2>
                                <p>City: {{ teacher.city }}</p>
                                <p>Price: {{ teacher.price }}â‚¬</p>
                                <div class="star-rating">
                                    <span class="star empty">&#9733;</span>
                                    <span class="star empty">&#9733;</span>
                                    <span class="star empty">&#9733;</span>
                                    <span class="star empty">&#9733;</span>
                                    <span class="star empty">&#9733;</span>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        {% else %}
            <div class="no-teachers">
                <h2>No teachers found for the subject {{ subject }}</h2>
                <p>Sorry, we couldn't find any teachers that match your criteria.</p>
                <img src="{% static 'imgs/not_found.png' %}" alt="not_found">
            </div>
        {% endif %}

        <script src="{% static 'js/star_rating.js' %}"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                const teacherContainers = document.querySelectorAll('.teacher-container');
                teacherContainers.forEach(container => {
                    const rating = parseFloat(container.dataset.rating);
                    const starRatingElement = container.querySelector('.star-rating');
                    viewStars(starRatingElement, rating);
                });
            });
        </script>
    </div>
{% endblock %}

{% block js %}{% endblock %}
